<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100% }
    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyASvWxvu96p44i3bEmdGuOpQtx98Lj-7Vo&sensor=false&libraries=visualization">
    </script>
    <script type="text/javascript">
      function initialize() {
        var styles = [
          {
            "featureType": "road",
            "stylers": [
              { "color": "#ffffff" }
            ]
          },{
            "featureType": "landscape",
            "stylers": [
              { "color": "#ecedec" }
            ]
          },{
            "elementType": "labels",
            "stylers": [
              { "visibility": "off" }
            ]
          },{
            "featureType": "poi",
            "stylers": [
              { "color": "#e0e0e0" }
            ]
          },{
            "featureType": "water",
            "stylers": [
              { "visibility": "off" }
            ]
          },{
            "featureType": "transit",
            "stylers": [
              { "visibility": "off" }
            ]
          },{
          }
        ];

        var mapOptions = {
          disableDefaultUI: true,
          panControl: false,
          zoomControl: false,
          scaleControl: false,
          center: new google.maps.LatLng(39.5, -98.35),
          zoom: 5,
          styles: styles
        };
        var map = new google.maps.Map(document.getElementById("map-canvas"),
            mapOptions);

        // get points from sample data and build heatmap
        $.getJSON("sample_data.json", function(results) {
          // update counter
          $("#med_counter").html(thousandSeparator(results.length.toString()));
          var sampleData = [];
          for (var i = 0; i < results.length; i++) {
            var location = results[i];
            sampleData.push(new google.maps.LatLng(location.lat, location.lng));
          }

          var pointArray = new google.maps.MVCArray(sampleData);

          var heatmap = new google.maps.visualization.HeatmapLayer({
            data: pointArray,
            radius: 100,
            opacity: 0.5
          });

          heatmap.setMap(map);
        });
      }
      google.maps.event.addDomListener(window, 'load', initialize);

      function thousandSeparator(n) {
            var sRegExp = new RegExp('(-?[0-9]+)([0-9]{3})');
            var sValue=n;
            var sep=',';
            while(sRegExp.test(sValue)) {
            sValue = sValue.replace(sRegExp, '$1'+sep+'$2');
        }
        return sValue;
      }
    </script>
  </head>
  <body>
    <span id="med_counter"></span> people currently meditating. Ready to join the community? App Store linkies
    <div id="map-canvas"/>
  </body>
</html>
